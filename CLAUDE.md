# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with
code in this repository.

このファイルは、このリポジトリでコードを扱う際のClaude Code (claude.ai/code)
への指針を提供します。

## 関連ドキュメント

- @doc/development.md : 開発コマンド、アーキテクチャ、環境設定などの技術情報

## 重要ルール

- **重要**: このプロジェクトでは常に日本語で回答してください。
  - ただし、コードのコメントや @README.md は英語で記述すること。
- **重要**: 新しいルールを @CLAUDE.md に追加
  - ユーザーからの今回限りではなく常に対応が必要だと思われる指示を受けた場合、以下の手順に従ってください。
    1. ユーザーからの指示を確認し、必要なルールを特定します。
    2. `CLAUDE.md` ファイルに新しいルールを追加します。
    3. ルールが追加されたことをユーザーに通知します。
- 現在時刻が必要な際は MCP ツールの `time:get_current_time` を使用すること

## 開発ルール

- コードが完成したら`deno task preCommit`で品質をチェックする
- プルリクエスト作成や更新を行った場合、コンフルエンスの進捗ページを追加・更新する（後述）
- **重要**:
  プルリクエスト作成・更新後は必ずConfluence進捗ページの作成・更新を行う
  - 作業完了の最終ステップとして位置づける
  - ユーザーが明示的に依頼しなくても自動的に実行する
- 外部仕様が変更された場合、コンフルエンスの仕様書ページ（id:`65690`）を更新する

### Confluence進捗管理

**進捗ページ作成ルール:**

- 進捗ページは「進捗 [Confluence MCP Server]」(ID: 262145) の下に配置
  - 進捗ページが存在する場合は更新。存在しない場合は新規作成
- 日付別のページタイトル形式:
  `<YYYY>-<MM>-<DD>: <タスク名> [Confluence MCP Server]`
  - `<` と `>` はプレースホルダーである。実際の値に置き換えること
- 進捗ページには以下の情報を含めること:
  - 実施したタスクの概要
  - 実施したタスクによって何が達成されたか
  - claude code 利用者とのやりとり（意思決定）の変遷を箇条書きする
    - どういった要望を投げられたかから始める
  - プルリクエストへのリンク

**テンプレート**

```markdown
/toc

## Pull Request

## 概要

## 何が達成されたか

## 意思決定の変遷
```

（実際に作成する際は Confluence Storage Format を使ってください。）

**スペース情報:**

- スペースキー: `~55705871b95d105a43472fa662f76cf8b0c09d`
- 進捗ページの親ID: `262145`

**ページ構造:**

```
概要 (ID: 131182) - ホームページ
└── Confluence MCP Server の開発 (ID: 131187)
    ├── Confluence MCP Server 仕様書 (ID: 65690)
    └── 進捗 [Confluence MCP Server] (ID: 262145) ← 進捗ページの親
        └── <YYYY>-<MM>-<DD>: <タスク名> [Confluence MCP Server]
```
